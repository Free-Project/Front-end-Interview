## React函数式组件较类组件的优势


### Hook 的设计在某些方面更加高效：  
参考官方描述：https://zh-hans.reactjs.org/docs/hooks-faq.html#are-hooks-slow-because-of-creating-functions-in-render

- Hook 避免了 class 需要的额外开支，像是创建类实例和在构造函数中绑定事件处理器的成本。
- 符合语言习惯的代码在使用 Hook 时不需要很深的组件树嵌套。这个现象在使用高阶组件、render props、和 context 的代码库中非常普遍。组件树小了，React 的工作量也随之减少。


传统上认为，在 React 中使用内联函数对性能的影响，与每次渲染都传递新的回调会如何破坏子组件的 shouldComponentUpdate 优化有关。  
Hook 从三个方面解决了这个问题。

1. useCallback Hook 允许你在重新渲染之间保持对相同的回调引用以使得 shouldComponentUpdate 继续工作：
```
// 除非 `a` 或 `b` 改变，否则不会变
const memoizedCallback = useCallback(() => {
  doSomething(a, b);
}, [a, b]);
```

2. useMemo Hook 使得控制具体子节点何时更新变得更容易，减少了对纯组件的需要。
3. 最后，useReducer Hook 减少了对深层传递回调的依赖，正如下面解释的那样。



### 区别
1. 类组件的性能消耗比较大，因为类组件需要创建类组件的实例，而且不能销毁。
2. 函数式组件性能消耗小，因为函数式组件不需要创建实例，渲染的时候就执行一下，得到返回的react元素后就直接把中间量全部都销毁。

通常，函数（function）与类（class）最大的区别是：是否能够维护自己的数据（即状态）。函数基本上仅关注动作（action），而不关心数据的维护，不用维持一个状态，不用把自己的数据保存在内存中。函数使用的数据是从外部获取（或者不获取数据），函数运行时，会完成一系列的动作，最后将结果返回（也可能不返回，仅仅是完成指定的动作）。相对而言，类有能力维护状态（保存数据），也可以定义自己的一系列动作。  

一般来说，函数的速度较快，适合用于做表现层，而类能够处理复杂逻辑和状态，适合做逻辑层和数据层。所以，对于 React 来说，一般选择函数来无状态组件，得到所谓的无状态函数（stateless function），好处是渲染的速度快，所以多使用无状态组件，尽量不要让数据散落在各个组件中。数据集中管理可以更好的保持数据的一致性和可维护性。  

有状态组件就是使用类来生成。类可以有自己的状态，维护自己的数据，也是完全符合有状态组件的要求。但是类相对来说速度比函数慢，影响渲染的性能，同时数据过于分散会给后期的维护带来比较大的困难（这也是为什么状态过多时要使用 Redux 的原因），因此要尽量控制有状态组件的数量。当然，类也可以生成无状态组件，但是既然不需要维护状态的工作，用函数能完成得更好，其实也就没有必要使用类来做无状态组件。



### 为什么React Hook 组件更好的复用？

1. 组件不会被实例化，整体渲染性能得到提升
2. 类组件需要在生命周期中编写大量重复代码，而函数式组件可以提取类组件生命周期中重复逻辑代码提取到hook API中，以便于复用
3. 类组件很难拆分和重构，因为数据state封装在类内部，业务逻辑分散在组件的各个方法之中，导致重复逻辑或关联逻辑；此外类组件引入了复杂的编程模式，比如 render props 和高阶组件

### React Hook特征
- 只在 React 函数中调用 Hook
- 只在最顶层使用 Hook，不能在循环或者其他语句块内部使用
- 组件不能访问this对象
- 自定义 hook 时，可以调用别的hook
